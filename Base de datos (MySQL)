CREATE DATABASE LIBRERIA;
USE LIBRERIA;

CREATE TABLE usuario(
id_usuario int not null auto_increment,
nombre varchar(50),
contraseña varchar(24),
cargo varchar(20),
primary key (id_usuario)
);

CREATE TABLE autor(
cod_autor int not null auto_increment,
nombre varchar(50),
primary key (cod_autor)
);

CREATE TABLE editorial(
cod_editorial int not null auto_increment,
nombre_editorial varchar(50),
primary key (cod_editorial)
);

CREATE TABLE tipo_producto(
cod_tipo_producto int not null auto_increment,
nombre_tipo varchar(20),
primary key (cod_tipo_producto)
);

CREATE TABLE producto(
cod_producto int not null auto_increment,
nombre varchar(50),
stock int,
cod_tipo_producto int,
primary key (cod_producto),
foreign key (cod_tipo_producto) references tipo_producto(cod_tipo_producto)
);


CREATE TABLE producto_usuario(
cod_producto_usuario int not null auto_increment,
cod_producto int not null,
id_usuario int not null,
primary key (cod_producto_usuario),
foreign key (cod_producto) references producto(cod_producto),
foreign key (id_usuario) references usuario(id_usuario)
);


CREATE TABLE bodega(
cod_bodega int not null auto_increment,
nombre_bodega varchar(50),
primary key (cod_bodega)
);

CREATE TABLE producto_bodega(
cod_producto_bodega int not null auto_increment,
cod_bodega int not null,
cod_producto int not null,
primary key (cod_producto_bodega),
foreign key (cod_bodega)references bodega(cod_bodega),
foreign key (cod_producto) references producto(cod_producto)
);

CREATE TABLE autor_producto(
cod_autor_producto int not null auto_increment,
cod_autor int not null,
cod_producto int not null,
primary key (cod_autor_producto),
foreign key (cod_autor) references autor(cod_autor),
foreign key (cod_producto) references producto(cod_producto)
);

CREATE TABLE movimiento(
id_movimiento int not null auto_increment,
bodega_origen varchar(50),
bodega_destino varchar(50),
producto varchar(50),
cantidad int,
tipo_movimiento varchar(10),
cod_producto int not null,
cod_bodega int not null,
primary key (id_movimiento),
foreign key (cod_producto) references producto(cod_producto),
foreign key (cod_bodega) references bodega(cod_bodega)
);

/*INICIO EJEMPLO DE INICIO DE SESION (PARTE BASE DE DATOS)*/

insert into usuario(nombre,contraseña,cargo)
values ('fabian','fabian','jefe de bodega');


insert into autor(nombre)
values ('J.K.Rowling');


insert into tipo_producto (nombre_tipo)
values ('libro');


insert into bodega (nombre_bodega)
values('bodega01');
insert into bodega (nombre_bodega)
values('bodega02');

insert into editorial (nombre_editorial)
values ('Salamandra');


INSERT INTO producto (nombre, stock,cod_tipo_producto)
VALUES ('Harry Potter y la piedra filosofal', 99,1);


INSERT INTO producto_usuario (cod_producto, id_usuario)
VALUES (1, 1);


insert into autor_producto(cod_autor,cod_producto)
values (1,1);


insert into producto_bodega (cod_bodega,cod_producto)
values(1,1);


insert into movimiento (bodega_origen,bodega_destino,producto,cantidad,tipo_movimiento,cod_producto,cod_bodega)
values('bodega01','bodega02','Harry Potter y la piedra filosofal',20,'salida',1,1);

insert into tipo_producto(nombre_tipo)
values('revista');

insert into producto(nombre,stock,cod_tipo_producto)
values('Harry Potter y la camara secreta', 99,1);

insert into movimiento (bodega_origen,bodega_destino,producto,cantidad,tipo_movimiento,cod_producto,cod_bodega)
values('bodega01','bodega,02','Harry Potter y la camara secreta',25,'entrada',2,1);

insert into usuario(nombre, contraseña, cargo) value("Matias Sepulveda", "M4t12003!", "Bodeguero");
select * from usuario;
